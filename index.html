<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°é‡åŸå½©é¦™ã®ç ”ç©¶æˆé•·æ¨¹</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Noto Sans JP", "æ¸¸ã‚´ã‚·ãƒƒã‚¯", "Yu Gothic", sans-serif;
            background: linear-gradient(135deg, #a8e6cf 0%, #dcedc8 30%, #f1f8e9 70%, #e8f5e8 100%);
            min-height: 100vh;
            color: #2e5233;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(circle at 20% 20%, rgba(76, 175, 80, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(139, 195, 74, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        .main-title {
            text-align: center;
            margin-bottom: 40px;
            background: rgba(255, 255, 255, 0.9);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .main-title h1 {
            font-size: 2.8em;
            color: #1b5e20;
            font-weight: 600;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(76, 175, 80, 0.1);
        }

        .subtitle {
            font-size: 1.2em;
            color: #4a7c59;
            font-weight: 300;
            font-style: italic;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            border: 2px solid #c8e6c9;
            overflow-x: auto;
            position: relative;
        }

        .tree-svg {
            width: 100%;
            height: 1000px;
            min-width: 1200px;
            cursor: move;
        }

        .node {
            cursor: pointer;
        }

        .node-circle {
            transition: all 0.3s ease;
        }

        .node:hover .node-circle {
            stroke-width: 4;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
        }

        .node-text {
            font-family: "Noto Sans JP", sans-serif;
            pointer-events: none;
            filter: drop-shadow(2px 2px 3px rgba(0,0,0,0.8));
        }

        .link {
            fill: none;
            stroke: #5d4037;
            transition: all 0.3s ease;
        }

        .link:hover {
            stroke: #4a2c2a;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        }

        .link.has-papers {
            stroke: #8d6e63;
        }

        .paper-indicator {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .paper-indicator:hover {
            transform: scale(1.2);
        }

        .paper-tooltip {
            position: absolute;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.98), rgba(248, 255, 248, 0.95));
            border: 2px solid #8bc34a;
            border-radius: 15px;
            padding: 20px;
            font-size: 0.85em;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1001;
            max-width: 500px;
            min-width: 300px;
            max-height: 600px;
            overflow-y: auto;
        }

        .paper-tooltip.visible {
            opacity: 1;
        }

        .paper-tooltip h4 {
            color: #1b5e20;
            font-size: 1.1em;
            margin-bottom: 15px;
            font-weight: 600;
            border-bottom: 2px solid #c8e6c9;
            padding-bottom: 8px;
        }

        .paper-item {
            margin-bottom: 12px;
            padding: 8px 12px;
            background: rgba(139, 195, 74, 0.1);
            border-radius: 8px;
            border-left: 3px solid #66bb6a;
        }

        .paper-title {
            font-weight: 600;
            color: #2e5233;
            margin-bottom: 4px;
            line-height: 1.3;
            font-size: 0.9em;
        }

        .paper-meta {
            color: #4a7c59;
            font-size: 0.85em;
            font-style: italic;
        }

        .paper-count {
            background: #66bb6a;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .tooltip {
            position: absolute;
            background: rgba(255, 255, 255, 0.95);
            border: 2px solid #c8e6c9;
            border-radius: 10px;
            padding: 12px;
            font-size: 0.9em;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
            max-width: 300px;
        }

        .tooltip.visible {
            opacity: 1;
        }

        .info-section {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            border: 2px solid #a5d6a7;
        }

        .info-section h3 {
            color: #1b5e20;
            font-size: 1.8em;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
        }

        .collaboration-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .collaboration-item {
            background: linear-gradient(135deg, rgba(139, 195, 74, 0.1), rgba(165, 214, 167, 0.1));
            border: 1px solid rgba(129, 199, 132, 0.3);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .collaboration-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(129, 199, 132, 0.2);
        }

        .timeline-items {
            display: grid;
            gap: 15px;
        }

        .timeline-item {
            background: linear-gradient(135deg, rgba(102, 187, 106, 0.1), rgba(129, 199, 132, 0.1));
            border: 1px solid rgba(139, 195, 74, 0.3);
            border-radius: 15px;
            padding: 20px;
            border-left: 5px solid #66bb6a;
            transition: all 0.3s ease;
        }

        .timeline-item:hover {
            transform: translateX(10px);
            box-shadow: 0 8px 25px rgba(139, 195, 74, 0.2);
        }

        .year {
            font-weight: 600;
            color: #2e5233;
            font-size: 1.1em;
        }

        .chart-note {
            text-align: center;
            color: #4a7c59;
            font-style: italic;
            margin-top: 20px;
            padding: 15px;
            background: rgba(139, 195, 74, 0.1);
            border-radius: 10px;
            border: 1px solid rgba(139, 195, 74, 0.2);
        }

        .legend {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid #c8e6c9;
            border-radius: 10px;
            padding: 10px 12px;
            font-size: 0.85em;
            z-index: 10;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
            font-size: 0.8em;
        }

        .legend-item:last-child {
            margin-bottom: 0;
        }

        .legend-circle {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            margin-right: 8px;
            flex-shrink: 0;
        }

        .controls {
            position: absolute;
            bottom: 10px;
            left: 10px;
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid #c8e6c9;
            border-radius: 10px;
            padding: 10px;
            font-size: 0.85em;
            z-index: 10;
        }

        .controls button {
            background: #66bb6a;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 5px 15px;
            margin: 0 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .controls button:hover {
            background: #4caf50;
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px 15px;
            }
            
            .main-title h1 {
                font-size: 2.2em;
            }
            
            .tree-svg {
                height: 700px;
            }
            
            .main-title {
                padding: 20px;
            }
            
            .chart-container {
                padding: 20px;
            }
            
            .legend {
                position: static;
                margin-bottom: 20px;
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="main-title">
            <h1>ğŸŒ³ å°é‡åŸå½©é¦™ã®ç ”ç©¶æˆé•·æ¨¹</h1>
            <div class="subtitle">æ ¹ã‹ã‚‰å¹¹ã€æã‚’çµŒã¦è‘‰ã¸ã¨æˆé•·ã™ã‚‹ç ”ç©¶ã®ç³»çµ±ç™ºç”Ÿ - åŠ›å­¦çš„é…ç½®ã«ã‚ˆã‚Šè‡ªç„¶ã«åºƒãŒã‚‹çŸ¥è­˜ã®æ¨¹</div>
        </div>
        
        <div class="chart-container">
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-circle" style="background: #6d4c41;"></div>
                    <span>æ ¹ã£ã“ï¼šç ”ç©¶è€…</span>
                </div>
                <div class="legend-item">
                    <div class="legend-circle" style="background: #8d6e63;"></div>
                    <span>å¹¹ï¼šä¸»è¦ç ”ç©¶åˆ†é‡</span>
                </div>
                <div class="legend-item">
                    <div class="legend-circle" style="background: #66bb6a;"></div>
                    <span>æï¼šè©³ç´°ç ”ç©¶é ˜åŸŸ</span>
                </div>
                <div class="legend-item">
                    <div class="legend-circle" style="background: #ff6b6b;"></div>
                    <span>è‘‰ï¼šè«–æ–‡ï¼ˆå¹´è¡¨ç¤ºï¼‰</span>
                </div>
            </div>
            <div class="controls">
                <button id="restart-simulation">é…ç½®ã‚’ãƒªã‚»ãƒƒãƒˆ</button>
                <button id="freeze-simulation">é…ç½®ã‚’å›ºå®š</button>
            </div>
            <svg class="tree-svg" id="tree-chart"></svg>
            <div class="chart-note">
                ğŸŒ³ åŠ›å­¦çš„é…ç½®ã«ã‚ˆã‚Šè‡ªç„¶ã«åºƒãŒã‚‹ç ”ç©¶ç³»çµ±æ¨¹<br>
                ğŸ” ãƒãƒ¼ãƒ‰ã‚’ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦é…ç½®ã‚’èª¿æ•´ã§ãã¾ã™ã€‚å„è¦ç´ ã‚’ãƒ›ãƒãƒ¼ã—ã¦è©³ç´°ã‚’ã”è¦§ãã ã•ã„
            </div>
        </div>

        <div class="info-section">
            <h3>ğŸ“… ç ”ç©¶ç™ºå±•ã®æ™‚ç³»åˆ—</h3>
            <div class="timeline-items">
                <div class="timeline-item">
                    <span class="year">2024å¹´:</span> å¯¾è©±å‹AIãƒ¢ãƒ‡ãƒ«ã¨éŸ³å£°æŠ€è¡“ã®æ•™è‚²å¿œç”¨
                </div>
                <div class="timeline-item">
                    <span class="year">2023å¹´:</span> ãƒ™ã‚¤ã‚¸ã‚¢ãƒ³ç³»çµ±ç™ºç”Ÿè§£æè«–æ–‡ (Journal of Language Evolution)
                </div>
                <div class="timeline-item">
                    <span class="year">2022å¹´:</span> é€²åŒ–çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«ã‚ˆã‚‹ã‚¢ã‚¯ã‚»ãƒ³ãƒˆæ©Ÿèƒ½ç ”ç©¶é–‹å§‹
                </div>
                <div class="timeline-item">
                    <span class="year">2018-2023å¹´:</span> é›†å›£æ§‹é€ ã‚’è€ƒæ…®ã—ãŸè¨€èªå¤‰åŒ–ãƒ—ãƒ­ã‚»ã‚¹ç ”ç©¶
                </div>
                <div class="timeline-item">
                    <span class="year">2016-2019å¹´:</span> è¨€èªå¤‰åŒ–è¦å› ã¨ç³»è­œã®å®šé‡çš„è©•ä¾¡ç ”ç©¶
                </div>
                <div class="timeline-item">
                    <span class="year">2013-2017å¹´:</span> æ•°ç†çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«ã‚ˆã‚‹è¨€èªå‹•æ…‹ç ”ç©¶ï¼ˆåšå£«ç ”ç©¶ï¼‰
                </div>
                <div class="timeline-item">
                    <span class="year">2010-2013å¹´:</span> æ–¹è¨€åˆ†å¸ƒãƒ»æ–‡åŒ–é ˜åŸŸåˆ†æã®åŸºç¤ç ”ç©¶
                </div>
            </div>
        </div>
    </div>

    <div class="tooltip" id="tooltip"></div>
    <div class="paper-tooltip" id="paper-tooltip"></div>

    <script>
        // ç ”ç©¶ãƒ‡ãƒ¼ã‚¿ï¼ˆè«–æ–‡æƒ…å ±ä»˜ãï¼‰- è«–æ–‡ã‚’ç¬¬4éšå±¤ã¨ã—ã¦è¿½åŠ  
        const treeData = {
            name: 'å°é‡åŸå½©é¦™',
            description: 'è¨€èªå­¦ãƒ»æ–‡åŒ–é€²åŒ–ãƒ»ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹ç ”ç©¶è€…',
            level: 0,
            children: [
                {
                    name: 'è¨€èªé€²åŒ–ç ”ç©¶',
                    description: 'ãƒ™ã‚¤ã‚¸ã‚¢ãƒ³ç³»çµ±ç™ºç”Ÿè§£æãƒ»ã‚¢ã‚¯ã‚»ãƒ³ãƒˆç ”ç©¶',
                    level: 1,
                    children: [
                        { 
                            name: 'ã‚¢ã‚¯ã‚»ãƒ³ãƒˆç³»çµ±ç™ºç”Ÿå­¦', 
                            description: 'ãƒ™ã‚¤ã‚¸ã‚¢ãƒ³ç³»çµ±ç™ºç”Ÿè§£æã«ã‚ˆã‚‹ãƒ”ãƒƒãƒã‚¢ã‚¯ã‚»ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ', 
                            level: 2,
                            papers: [
                                {
                                    title: 'Bayesian phylogenetic analysis of pitch-accent systems based on accentual class merger: a new method applied to Japanese dialects',
                                    journal: 'Journal of Language Evolution',
                                    year: '2024',
                                    details: '8(2) 169-191, æŸ»èª­æœ‰ã‚Š'
                                },
                                {
                                    title: 'Inferring the temporal and spatial evolution of accent systems in Japanese dialects: a phylogeographic approach',
                                    journal: 'Proceedings of the Joint Conference on Language Evolution',
                                    year: '2022',
                                    details: 'æŸ»èª­æœ‰ã‚Š'
                                }
                            ]
                        },
                        { 
                            name: 'æ–¹è¨€ã®æ™‚ç©ºé–“å¤‰ç•°', 
                            description: 'æ—¥æœ¬èªæ–¹è¨€ã®ã‚¢ã‚¯ã‚»ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ã®æ™‚ç©ºé–“é€²åŒ–', 
                            level: 2,
                            papers: [
                                {
                                    title: 'è¨€èªã®æ¶ˆå¤±ã¨ç²å¾—ã«é–¢é€£ã™ã‚‹ç’°å¢ƒãƒ»ç¤¾ä¼šçš„è¦å› ',
                                    journal: 'GISï¼ç†è«–ã¨å¿œç”¨',
                                    year: '2016',
                                    details: '24(2), æ‹›å¾…æœ‰ã‚Š'
                                },
                                {
                                    title: 'æ—¥æœ¬èªæ–¹è¨€ã®æ¨å®šã•ã‚ŒãŸã‚¢ã‚¯ã‚»ãƒ³ãƒˆé¡åˆ¥ã®ä½µåˆç‡ã®ç³»çµ±åœ°ç†',
                                    journal: 'GISï¼ç†è«–ã¨å¿œç”¨',
                                    year: '2016',
                                    details: '24(2), æ‹›å¾…æœ‰ã‚Š'
                                },
                                {
                                    title: 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®æ–‡åŒ–ä¼é”ãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã‚‹æ—¥æœ¬èªã‚¢ã‚¯ã‚»ãƒ³ãƒˆæ§˜å¼ã®å¤‰ç•°ç‡ãƒ»ç³»çµ±é–¢ä¿‚ã®æ¨å®š',
                                    journal: 'å›½ç«‹å›½èªç ”ç©¶æ‰€ æ™‚ç©ºé–“å¤‰ç•°ç ”ç©¶ç³» åˆåŒç ”ç©¶ç™ºè¡¨ä¼š JLVC2012 äºˆç¨¿é›†',
                                    year: '2012',
                                    details: '43-46, æŸ»èª­æœ‰ã‚Š'
                                }
                            ]
                        },
                        { 
                            name: 'è¨€èªå¤‰åŒ–ãƒ¢ãƒ‡ãƒ«', 
                            description: 'æ•°ç†çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«ã‚ˆã‚‹è¨€èªå‹•æ…‹', 
                            level: 2,
                            papers: [
                                {
                                    title: 'æ•°ç†çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‹ã‚‰ã®è¨€èªå¤‰åŒ–ã¨å¤–è¨€èªçš„è¦ç´ ã¨ã®é–¢ã‚ã‚Šã«é–¢ã™ã‚‹ç ”ç©¶',
                                    journal: '',
                                    year: '2014',
                                    details: 'æŸ»èª­æœ‰ã‚Šç­†é ­è‘—è€…'
                                },
                                {
                                    title: 'äº¤é€šç³»çµ±è¨ˆæƒ…å ±ã®åˆ†å¸ƒã¨è¨€èªå¤–çš„è¦ç´ ã«é–¢ã™ã‚‹ç ”ç©¶',
                                    journal: 'æƒ…å ±å‡¦ç†å­¦ä¼šã‚·ãƒ³ãƒã‚¸ã‚¦ãƒ è«–æ–‡é›†',
                                    year: '2010',
                                    details: '2010(15) 239-246, æŸ»èª­æœ‰ã‚Š'
                                }
                            ]
                        }
                    ]
                },
                {
                    name: 'æ–‡åŒ–é€²åŒ–ç†è«–',
                    description: 'æ–‡åŒ–ä¼é”ãƒ¢ãƒ‡ãƒ«ãƒ»å®šé‡åˆ†æ',
                    level: 1,
                    children: [
                        { 
                            name: 'æ–‡åŒ–å¤šæ§˜æ€§æ©Ÿæ§‹', 
                            description: 'æ–‡åŒ–çš„å¤šæ§˜æ€§ã®é€²åŒ–ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ', 
                            level: 2,
                            papers: [
                                {
                                    title: 'é›‘èªŒã€Œè¡Œå‹•è¨ˆé‡å­¦ã€ã«ãŠã‘ã‚‹è¨€èªã«é–¢ã™ã‚‹æŠ•ç¨¿è«–æ–‡ã®å‚¾å‘',
                                    journal: 'æ—¥æœ¬è¡Œå‹•è¨ˆé‡å­¦ä¼šå¤§ä¼šç™ºè¡¨è«–æ–‡æŠ„éŒ²é›†',
                                    year: '2012',
                                    details: '40 415-418'
                                }
                            ]
                        },
                        { 
                            name: 'æ–‡åŒ–ä¼é”ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯', 
                            description: 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®æ–‡åŒ–ä¼é”ãƒ¢ãƒ‡ãƒ«', 
                            level: 2,
                            papers: [
                                {
                                    title: 'ITMAã«ãŠã‘ã‚‹NCDã®å®Ÿç”¨æ€§ã¨UMLã‚’ç”¨ã„ãŸåˆ†æãƒ—ãƒ­ã‚»ã‚¹ã®å¯è¦–åŒ–ã¨å…±æœ‰ã«ã¤ã„ã¦',
                                    journal: 'æƒ…å ±å‡¦ç†å­¦ä¼šã‚·ãƒ³ãƒã‚¸ã‚¦ãƒ è«–æ–‡é›†',
                                    year: '2010',
                                    details: '2010(15) 239-246, æŸ»èª­æœ‰ã‚Š'
                                },
                                {
                                    title: 'å²é˜œçœŒæ—§å¾³å±±æ‘ã«ãŠã‘ã‚‹ã‚¢ã‚¯ã‚»ãƒ³ãƒˆæ§˜ç›¸ã¨äº¤é€šçŠ¶æ³ã¨ã®é–¢ä¿‚æ€§-ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ†æã‚’ç”¨ã„ãŸã‚¢ã‚¯ã‚»ãƒ³ãƒˆåˆ†å¸ƒã¨äº¤é€šçŠ¶æ³ã®é¡ä¼¼æ€§ã®ç®—å‡º-',
                                    journal: 'æƒ…å ±å‡¦ç†å­¦ä¼šã‚·ãƒ³ãƒã‚¸ã‚¦ãƒ è«–æ–‡é›†',
                                    year: '2011',
                                    details: '2011(8) 219-224, æŸ»èª­æœ‰ã‚Šç­†é ­è‘—è€…'
                                }
                            ]
                        },
                        { 
                            name: 'å®šé‡çš„æ–¹è¨€å­¦', 
                            description: 'å²é˜œçœŒæ–¹è¨€èªå½™ã«ã‚ˆã‚‹æ–‡åŒ–é ˜åŸŸæŠ½å‡º', 
                            level: 2,
                            papers: [
                                {
                                    title: 'å²é˜œçœŒæ–¹è¨€èªå½™ã«ã‚ˆã‚‹ä»®æƒ³çš„æ–‡åŒ–é ˜åŸŸæŠ½å‡ºã¨èªå½™å¤‰åŒ–ã®æ–¹å‘',
                                    journal: 'ç ”ç©¶å ±å‘Šäººæ–‡ç§‘å­¦ã¨ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ï¼ˆCHï¼‰',
                                    year: '2012',
                                    details: '2012(4) 1-6, ç­†é ­è‘—è€…'
                                },
                                {
                                    title: 'æ–æ–å·ä¸ŠæµåŸŸã«ãŠã‘ã‚‹èªå½™ã®é¡å‹ã¨åœ°ç†çš„åˆ†å¸ƒ',
                                    journal: 'æ–‡åŒ–æƒ…å ±å­¦',
                                    year: '2012',
                                    details: '8(1) 1-11, æŸ»èª­æœ‰ã‚Šç­†é ­è‘—è€…'
                                },
                                {
                                    title: 'æ–æ–å·ä¸ŠæµåŸŸã®èªå½™ã«é–¢ã™ã‚‹ç³»çµ±æ¨å®š',
                                    journal: 'ç ”ç©¶å ±å‘Šäººæ–‡ç§‘å­¦ã¨ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ï¼ˆCHï¼‰',
                                    year: '2012',
                                    details: '2012(4) 1-6'
                                }
                            ]
                        }
                    ]
                },
                {
                    name: 'GISãƒ»ç©ºé–“åˆ†æ',
                    description: 'åœ°ç†æƒ…å ±ã‚·ã‚¹ãƒ†ãƒ ãƒ»æ©Ÿæ¢°å­¦ç¿’å¿œç”¨',
                    level: 1,
                    children: [
                        { 
                            name: 'ãƒ¯ã‚¤ãƒ³æ ½åŸ¹é©åœ°', 
                            description: 'æ©Ÿæ¢°å­¦ç¿’ã‚’ç”¨ã„ãŸãƒ¯ã‚¤ãƒ³ç”¨ãƒ–ãƒ‰ã‚¦æ ½åŸ¹é©åœ°æ¨å®š', 
                            level: 2,
                            papers: [
                                {
                                    title: 'æ©Ÿæ¢°å­¦ç¿’ã‚’ç”¨ã„ãŸãƒ¯ã‚¤ãƒ³ç”¨ãƒ–ãƒ‰ã‚¦æ ½åŸ¹é©åœ°ã®æ¨å®š',
                                    journal: 'GIS-ç†è«–ã¨å¿œç”¨',
                                    year: '2023',
                                    details: '31(2) 78-78, æ‹›å¾…æœ‰ã‚Š'
                                },
                                {
                                    title: 'CLIENT-SIDE WEB MAPPING SYSTEM FOR VINEYARD SUITABILITY ASSESSMENT',
                                    journal: 'The International Archives of the Photogrammetry, Remote Sensing and Spatial Information Sciences',
                                    year: '2022',
                                    details: 'XLVIII-4/W1-2022 223-228, æŸ»èª­æœ‰ã‚Š'
                                }
                            ]
                        },
                        { 
                            name: 'ç©ºé–“è¨€èªå­¦', 
                            description: 'è¨€èªå¤‰åŒ–ã®åœ°ç†çš„ãƒ‘ã‚¿ãƒ¼ãƒ³', 
                            level: 2,
                            papers: [
                                {
                                    title: 'è¨€èªã®æ¶ˆå¤±ã¨ç²å¾—ã«é–¢é€£ã™ã‚‹ç’°å¢ƒãƒ»ç¤¾ä¼šçš„è¦å› ',
                                    journal: 'åœ°ç†æƒ…å ±ã‚·ã‚¹ãƒ†ãƒ å­¦ä¼šè¬›æ¼”è«–æ–‡é›†(CD-ROM)',
                                    year: '2016',
                                    details: '25 40-40, ç­†é ­è‘—è€…è²¬ä»»è‘—è€…'
                                },
                                {
                                    title: 'æ–¹è¨€åˆ†å¸ƒã‹ã‚‰è¦‹ãŸæ–‡åŒ–äº‹è±¡ã®æµé€šã¨æ»ç•™â€•å²é˜œçœŒã«ãŠã‘ã‚‹æ–¹è¨€åˆ†å¸ƒã®äº‹ä¾‹â€•',
                                    journal: 'åœ°ç†æƒ…å ±ã‚·ã‚¹ãƒ†ãƒ å­¦ä¼šè¬›æ¼”è«–æ–‡é›†(CD-ROM)',
                                    year: '2010',
                                    details: '19, 473-480'
                                }
                            ]
                        },
                        { 
                            name: 'æ–‡åŒ–åœ°ç†å­¦', 
                            description: 'æ–‡åŒ–äº‹è±¡ã®æµé€šã¨æ»ç•™åˆ†æ', 
                            level: 2,
                            papers: [
                                {
                                    title: 'Classification of land use/cover change in the Kanto region, Japan using FOSS4G and Open Data',
                                    journal: 'Free and Open Source Software for Geospatial (FOSS4G) Conference Proceedings',
                                    year: '2016',
                                    details: '13(16), æŸ»èª­æœ‰ã‚Š'
                                },
                                {
                                    title: 'æ–‡åŒ–çš„æƒ…å ±ã®æµé€šè·¯ã¨ãã®æ»ç•™â€•å²é˜œçœŒã‚’ä¾‹ã¨ã—ãŸæ–¹è¨€åˆ†å¸ƒã®è¦³ç‚¹ã‹ã‚‰â€•',
                                    journal: 'å­¦ç”Ÿãƒ»è‹¥æ‰‹ åœ°ç†ç©ºé–“æƒ…å ±ãƒ•ã‚©ãƒ¼ãƒ©ãƒ  in é–¢è¥¿ è«–æ–‡é›†',
                                    year: '2010',
                                    details: '51-58, ç­†é ­è‘—è€…'
                                },
                                {
                                    title: 'æ–¹è¨€åˆ†å¸ƒãƒ‡ãƒ¼ã‚¿ã®æ•°ç†çš„åˆ†æ(ç‰¹åˆ¥ã‚»ãƒƒã‚·ãƒ§ãƒ³ æ–¹è¨€åˆ†å¸ƒã¨è¨ˆé‡(2))',
                                    journal: 'æ—¥æœ¬è¡Œå‹•è¨ˆé‡å­¦ä¼šå¤§ä¼šç™ºè¡¨è«–æ–‡æŠ„éŒ²é›†',
                                    year: '2012',
                                    details: '40, 415-418'
                                }
                            ]
                        }
                    ]
                },
                {
                    name: 'AIãƒ»æ•™è‚²æŠ€è¡“',
                    description: 'ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹æ•™è‚²ãƒ»AIå¿œç”¨',
                    level: 1,
                    children: [
                        { 
                            name: 'AIæ•™è‚²ã‚³ãƒ³ãƒ†ãƒ³ãƒ„', 
                            description: 'å¯¾è©±å‹AIãƒ¢ãƒ‡ãƒ«ã®æ•™è‚²å¿œç”¨', 
                            level: 2,
                            papers: [
                                {
                                    title: 'å¯¾è©±å‹AIãƒ¢ãƒ‡ãƒ«ä¸¦ã³ã«AIéŸ³å£°ã‚’æ´»ç”¨ã—ãŸæ•™è‚²ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä½œæˆ â€•AIæŠ€è¡“ã®æ–°ãŸãªå±•é–‹â€•',
                                    journal: 'ç¤¾ä¼šã¨çµ±è¨ˆ',
                                    year: '2024',
                                    details: '(10) 27-44'
                                }
                            ]
                        },
                        { 
                            name: 'ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹æ•™è‚²', 
                            description: 'çµ±è¨ˆæ•™è‚²ã®è³ªä¿è¨¼ç ”ç©¶', 
                            level: 2,
                            papers: [
                                {
                                    title: 'çµ±è¨ˆæ•™è‚²ã«é–¢ã™ã‚‹æˆæ¥­å†…å®¹ã®å‚¾å‘ã¨å­¦ç”Ÿã®æˆæ¥­è©•ä¾¡ï¼šçµ±è¨ˆæ•™è‚²è³ªä¿è¨¼ã«é–¢ã™ã‚‹åˆ†æèª¿æŸ»',
                                    journal: 'æ–‡åŒ–æƒ…å ±å­¦',
                                    year: '2013',
                                    details: '9(1) 1-11, æŸ»èª­æœ‰ã‚Š'
                                },
                                {
                                    title: 'é€£æºæ ¡å­¦éƒ¨ã‚·ãƒ©ãƒã‚¹ã®å…¨å®¹ã¨åŒå¿—ç¤¾å¤§å­¦æ–‡åŒ–æƒ…å ±å­¦éƒ¨ã€Œãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹ç§‘ç›®ã€ã®ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆèª¿æŸ»',
                                    journal: 'æ–‡åŒ–æƒ…å ±å­¦',
                                    year: '2012',
                                    details: '8(1) 1-11, æŸ»èª­æœ‰ã‚Šç­†é ­è‘—è€…'
                                }
                            ]
                        },
                        { 
                            name: 'Python GISæ•™æ', 
                            description: 'Pythonåœ°ç†ç·åˆå®Ÿç¿’ã‚³ãƒ³ãƒ†ãƒ³ãƒ„', 
                            level: 2,
                            papers: [
                                {
                                    title: 'Python ã‚’åˆ©ç”¨ã—ãŸåœ°ç†ç·åˆå®Ÿç¿’ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ä½œæˆ',
                                    journal: 'æ—¥æœ¬åœ°ç†å­¦ä¼šç™ºè¡¨è¦æ—¨é›†',
                                    year: '2023',
                                    details: '2023s. P007'
                                },
                                {
                                    title: 'æ–¹è¨€åˆ†å¸ƒã‹ã‚‰è¦‹ãŸæ–‡åŒ–äº‹è±¡ã®æµé€šã¨æ»ç•™â€•å²é˜œçœŒã«ãŠã‘ã‚‹æ–¹è¨€åˆ†å¸ƒã®äº‹ä¾‹â€•',
                                    journal: 'æƒ…å ±å‡¦ç†å­¦ä¼šã‚·ãƒ³ãƒã‚¸ã‚¦ãƒ è«–æ–‡é›†',
                                    year: '2011',
                                    details: '2011(8) 219-224, æŸ»èª­æœ‰ã‚Šç­†é ­è‘—è€…'
                                }
                            ]
                        }
                    ]
                }
            ]
        };

        class TreeChart {
            constructor(svgId, data) {
                this.svgElement = document.getElementById(svgId);
                this.data = data;
                this.tooltip = document.getElementById('tooltip');
                this.paperTooltip = document.getElementById('paper-tooltip');
                this.width = 1200;
                this.height = 1000;
                this.nodeRadius = { 0: 30, 1: 20, 2: 15, 3: 8 };
                this.fontSize = { 0: '16px', 1: '12px', 2: '10px', 3: '8px' };
                this.init();
            }

            init() {
                // D3.jsã§SVGã‚’è¨­å®š
                this.svg = d3.select(this.svgElement)
                    .attr('viewBox', `0 0 ${this.width} ${this.height}`);
                
                // èƒŒæ™¯ã®ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®šç¾©
                const defs = this.svg.append('defs');
                const gradient = defs.append('radialGradient')
                    .attr('id', 'treeGradient')
                    .attr('cx', '50%')
                    .attr('cy', '100%')
                    .attr('r', '100%');
                
                gradient.append('stop')
                    .attr('offset', '0%')
                    .attr('stop-color', '#8d6e63')
                    .attr('stop-opacity', 0.1);
                
                gradient.append('stop')
                    .attr('offset', '100%')
                    .attr('stop-color', '#66bb6a')
                    .attr('stop-opacity', 0.05);
                
                // èƒŒæ™¯ã‚’è¿½åŠ 
                this.svg.append('rect')
                    .attr('width', this.width)
                    .attr('height', this.height)
                    .attr('fill', 'url(#treeGradient)');
                
                this.processData();
                this.createForceSimulation();
                this.setupControls();
            }

            processData() {
                const nodes = [];
                const links = [];
                let nodeId = 0;
                const height = this.height;
                const width = this.width;
                
                // ãƒ«ãƒ¼ãƒˆãƒãƒ¼ãƒ‰
                const root = {
                    id: nodeId++,
                    name: this.data.name,
                    description: this.data.description,
                    level: 0,
                    x: width / 2,
                    y: height - 100,
                    fx: width / 2,  // å›ºå®šXåº§æ¨™
                    fy: height - 100  // å›ºå®šYåº§æ¨™ï¼ˆä¸‹éƒ¨ï¼‰
                };
                nodes.push(root);

                // å†å¸°çš„ã«ãƒãƒ¼ãƒ‰ã¨ãƒªãƒ³ã‚¯ã‚’ä½œæˆ
                const processChildren = (parent, children, level) => {
                    if (!children) return;
                    
                    children.forEach((child, i) => {
                        const node = {
                            id: nodeId++,
                            name: child.name,
                            description: child.description,
                            level: level,
                            papers: child.papers || []
                        };
                        
                        // ãƒ¬ãƒ™ãƒ«ã«å¿œã˜ã¦åˆæœŸåº§æ¨™ã‚’è¨­å®š
                        if (level === 1) {
                            node.x = width / 2;
                            node.y = height - 250;
                        } else if (level === 2) {
                            node.x = width / 2;
                            node.y = height - 500;
                        } else {
                            node.x = width / 2;
                            node.y = height - 750;
                        }
                        
                        nodes.push(node);
                        
                        // ãƒªãƒ³ã‚¯ã‚’ä½œæˆï¼ˆç¬¬3éšå±¤ã¸ã®é·ç§»ã®å ´åˆã®ã¿papersã‚’å«ã‚ã‚‹ï¼‰
                        if (parent.level === 1 && child.papers && child.papers.length > 0) {
                            links.push({ source: parent.id, target: node.id, papers: child.papers });
                        } else {
                            links.push({ source: parent.id, target: node.id });
                        }
                        
                        // å­ãƒãƒ¼ãƒ‰ã‚’å‡¦ç†
                        if (child.children) {
                            processChildren(node, child.children, level + 1);
                        }
                        
                        // è«–æ–‡ãƒãƒ¼ãƒ‰ã‚’è¿½åŠ ï¼ˆç¬¬4éšå±¤ï¼‰
                        if (child.papers && child.papers.length > 0 && level === 2) {
                            const maxPapers = 5;
                            const papersToShow = Math.min(child.papers.length, maxPapers);
                            
                            child.papers.slice(0, papersToShow).forEach((paper, k) => {
                                const paperNode = {
                                    id: nodeId++,
                                    name: paper.year,
                                    description: paper.title,
                                    level: 3,
                                    paper: paper,
                                    x: node.x || width / 2,  // è¦ªãƒãƒ¼ãƒ‰ã®Xåº§æ¨™ã‚’ä½¿ç”¨
                                    y: height - 750  // è«–æ–‡ã¯æœ€ä¸Šéƒ¨
                                };
                                nodes.push(paperNode);
                                links.push({ source: node.id, target: paperNode.id });
                            });
                            
                            // è¿½åŠ ã®è«–æ–‡ãƒãƒ¼ãƒ‰
                            if (child.papers.length > maxPapers) {
                                const moreNode = {
                                    id: nodeId++,
                                    name: `+${child.papers.length - maxPapers}`,
                                    description: `ä»–${child.papers.length - maxPapers}ä»¶ã®è«–æ–‡`,
                                    level: 3,
                                    morePapers: child.papers.slice(maxPapers),
                                    x: node.x || width / 2,  // è¦ªãƒãƒ¼ãƒ‰ã®Xåº§æ¨™ã‚’ä½¿ç”¨
                                    y: height - 750
                                };
                                nodes.push(moreNode);
                                links.push({ source: node.id, target: moreNode.id });
                            }
                        }
                    });
                };

                processChildren(root, this.data.children, 1);
                
                this.nodes = nodes;
                this.links = links;
                
                // ãƒ‡ãƒãƒƒã‚°ç”¨ï¼šãƒãƒ¼ãƒ‰ã¨ãƒªãƒ³ã‚¯ã®æ•°ã‚’ç¢ºèª
                console.log('Total nodes:', this.nodes.length);
                console.log('Total links:', this.links.length);
            }

            createForceSimulation() {
                // ãƒãƒ¼ãƒ‰IDã¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ãƒãƒƒãƒ—ã‚’ä½œæˆ
                this.nodeMap = {};
                this.nodes.forEach((node, i) => {
                    this.nodeMap[node.id] = i;
                });
                
                // åŠ›å­¦ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆ
                this.simulation = d3.forceSimulation(this.nodes)
                    .force('link', d3.forceLink(this.links)
                        .id(d => d.id)
                        .distance(d => {
                            // ãƒ¬ãƒ™ãƒ«ã«å¿œã˜ã¦ãƒªãƒ³ã‚¯ã®é•·ã•ã‚’èª¿æ•´
                            const sourceNode = typeof d.source === 'object' ? d.source : this.nodes.find(n => n.id === d.source);
                            const targetNode = typeof d.target === 'object' ? d.target : this.nodes.find(n => n.id === d.target);
                            if (!sourceNode || !targetNode) return 100;
                            
                            if (sourceNode.level === 0) return 200;
                            if (sourceNode.level === 1) return 180;
                            if (sourceNode.level === 2) return 120;
                            return 80;
                        })
                        .strength(0.8))
                    .force('charge', d3.forceManyBody()
                        .strength(d => {
                            // ãƒ¬ãƒ™ãƒ«ã«å¿œã˜ã¦åç™ºåŠ›ã‚’èª¿æ•´
                            if (d.level === 0) return -2000;
                            if (d.level === 1) return -1500;
                            if (d.level === 2) return -1000;
                            return -600;
                        }))
                    .force('x', d3.forceX(d => {
                        // ãƒ¬ãƒ™ãƒ«ã”ã¨ã«ç•°ãªã‚‹Xæ–¹å‘ã®ä¸­å¿ƒã‚’è¨­å®š
                        return this.width / 2;
                    }).strength(0.02))
                    .force('y', d3.forceY(d => {
                        // Yæ–¹å‘ã®åŠ›ã‚’èª¿æ•´ã—ã¦éšå±¤æ§‹é€ ã‚’ç¶­æŒ
                        if (d.level === 0) return this.height - 100;
                        if (d.level === 1) return this.height - 250;
                        if (d.level === 2) return this.height - 500;
                        return this.height - 750;
                    }).strength(0.5))
                    .force('collision', d3.forceCollide()
                        .radius(d => this.nodeRadius[d.level] + 20));

                // ãƒªãƒ³ã‚¯ã‚’æç”»
                const linkGroup = this.svg.append('g').attr('class', 'links');
                const link = linkGroup.selectAll('path')
                    .data(this.links)
                    .enter().append('path')
                    .attr('class', d => d.papers && d.papers.length > 0 ? 'link has-papers' : 'link')
                    .attr('stroke', '#5d4037')
                    .attr('stroke-width', d => {
                        const sourceNode = typeof d.source === 'object' ? d.source : this.nodes.find(n => n.id === d.source);
                        if (!sourceNode) return 2;
                        if (sourceNode.level === 0) return 6;
                        if (sourceNode.level === 1) return 4;
                        return 2;
                    })
                    .attr('fill', 'none');

                // ãƒãƒ¼ãƒ‰ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½œæˆ
                const nodeGroup = this.svg.append('g').attr('class', 'nodes');
                const node = nodeGroup.selectAll('g')
                    .data(this.nodes)
                    .enter().append('g')
                    .attr('class', 'node')
                    .call(d3.drag()
                        .on('start', (event, d) => this.dragstarted(event, d))
                        .on('drag', (event, d) => this.dragged(event, d))
                        .on('end', (event, d) => this.dragended(event, d)));

                // ãƒãƒ¼ãƒ‰ã®å††ã‚’è¿½åŠ 
                node.append('circle')
                    .attr('r', d => this.nodeRadius[d.level])
                    .attr('class', d => `node-circle level-${d.level}`)
                    .attr('fill', d => {
                        if (d.level === 0) return '#6d4c41';
                        if (d.level === 1) return '#8d6e63';
                        if (d.level === 2) return '#66bb6a';
                        return '#ff6b6b';
                    })
                    .attr('stroke', '#ffffff')
                    .attr('stroke-width', 3);

                // ãƒãƒ¼ãƒ‰ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’è¿½åŠ ï¼ˆç¸å–ã‚Šä»˜ãï¼‰
                node.append('text')
                    .attr('class', 'node-text')
                    .attr('fill', 'white')
                    .attr('font-size', d => this.fontSize[d.level])
                    .attr('text-anchor', 'middle')
                    .attr('dominant-baseline', 'central')
                    .attr('stroke', '#2e5233')
                    .attr('stroke-width', '3px')
                    .attr('paint-order', 'stroke')
                    .text(d => d.name);
                
                // å‰é¢ã®ãƒ†ã‚­ã‚¹ãƒˆï¼ˆç™½è‰²ï¼‰
                node.append('text')
                    .attr('class', 'node-text')
                    .attr('fill', 'white')
                    .attr('font-size', d => this.fontSize[d.level])
                    .attr('text-anchor', 'middle')
                    .attr('dominant-baseline', 'central')
                    .text(d => d.name);

                // ãƒ›ãƒãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆ
                node.on('mouseenter', (event, d) => this.showTooltip(event, d))
                    .on('mouseleave', () => this.hideTooltip())
                    .on('mousemove', (event) => this.updateTooltipPosition(event));

                // è«–æ–‡ãŒã‚ã‚‹æã«ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã‚’è¿½åŠ 
                const paperIndicators = linkGroup.selectAll('.paper-indicator')
                    .data(this.links.filter(d => d.papers && d.papers.length > 0))
                    .enter().append('g')
                    .attr('class', 'paper-indicator-group');

                paperIndicators.append('circle')
                    .attr('r', 6)
                    .attr('fill', '#ff6b6b')
                    .attr('class', 'paper-indicator')
                    .on('mouseenter', (event, d) => {
                        const targetNode = typeof d.target === 'object' ? d.target : this.nodes.find(n => n.id === d.target);
                        if (targetNode) {
                            this.showPaperTooltip(event, d.papers, targetNode.name);
                        }
                    })
                    .on('mouseleave', () => this.hidePaperTooltip())
                    .on('mousemove', (event) => this.updatePaperTooltipPosition(event));

                paperIndicators.append('text')
                    .attr('fill', 'white')
                    .attr('font-size', '10px')
                    .attr('font-weight', 'bold')
                    .attr('text-anchor', 'middle')
                    .attr('dominant-baseline', 'central')
                    .attr('pointer-events', 'none')
                    .attr('stroke', '#8b0000')
                    .attr('stroke-width', '2px')
                    .attr('paint-order', 'stroke')
                    .text(d => d.papers.length);

                // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ†ã‚£ãƒƒã‚¯å‡¦ç†
                this.simulation.on('tick', () => {
                    // ãƒªãƒ³ã‚¯ã‚’æ›²ç·šã§æç”»
                    link.attr('d', d => {
                        const source = d.source;
                        const target = d.target;
                        if (!source || !target) return '';
                        const midY = (source.y + target.y) / 2;
                        return `M${source.x},${source.y} C${source.x},${midY} ${target.x},${midY} ${target.x},${target.y}`;
                    });

                    // ãƒãƒ¼ãƒ‰ã®ä½ç½®ã‚’æ›´æ–°
                    node.attr('transform', d => `translate(${d.x}, ${d.y})`);

                    // è«–æ–‡ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã®ä½ç½®ã‚’æ›´æ–°
                    paperIndicators.attr('transform', d => {
                        if (!d.source || !d.target) return '';
                        const midX = (d.source.x + d.target.x) / 2;
                        const midY = (d.source.y + d.target.y) / 2;
                        return `translate(${midX}, ${midY})`;
                    });
                });

                this.link = link;
                this.node = node;
                this.paperIndicators = paperIndicators;
            }

            dragstarted(event, d) {
                if (!event.active) this.simulation.alphaTarget(0.3).restart();
                d.fx = d.x;
                d.fy = d.y;
            }

            dragged(event, d) {
                d.fx = event.x;
                d.fy = event.y;
            }

            dragended(event, d) {
                if (!event.active) this.simulation.alphaTarget(0);
                // ãƒ¬ãƒ™ãƒ«0ï¼ˆãƒ«ãƒ¼ãƒˆï¼‰ã¯å›ºå®š
                if (d.level !== 0) {
                    d.fx = null;
                    d.fy = null;
                }
            }

            setupControls() {
                document.getElementById('restart-simulation').addEventListener('click', () => {
                    // å…¨ãƒãƒ¼ãƒ‰ã®å›ºå®šã‚’è§£é™¤ã—ã¦ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å†é–‹
                    this.nodes.forEach(d => {
                        if (d.level !== 0) {
                            d.fx = null;
                            d.fy = null;
                        }
                    });
                    this.simulation.alpha(1).restart();
                });

                document.getElementById('freeze-simulation').addEventListener('click', () => {
                    // ç¾åœ¨ã®ä½ç½®ã§å…¨ãƒãƒ¼ãƒ‰ã‚’å›ºå®š
                    this.nodes.forEach(d => {
                        d.fx = d.x;
                        d.fy = d.y;
                    });
                });
            }

            showTooltip(event, node) {
                let content = `<strong>${node.name}</strong><br>${node.description}`;
                if (node.paper) {
                    content = `<strong>${node.paper.title}</strong><br>${node.paper.journal} ${node.paper.year}<br>${node.paper.details}`;
                } else if (node.morePapers) {
                    content = `<strong>è¿½åŠ ã®è«–æ–‡</strong><br>`;
                    node.morePapers.forEach(paper => {
                        content += `ãƒ»${paper.title}<br>`;
                    });
                }
                this.tooltip.innerHTML = content;
                this.tooltip.classList.add('visible');
                this.updateTooltipPosition(event);
            }

            hideTooltip() {
                this.tooltip.classList.remove('visible');
            }

            updateTooltipPosition(event) {
                this.tooltip.style.left = `${event.clientX + 10}px`;
                this.tooltip.style.top = `${event.clientY - 10}px`;
            }

            showPaperTooltip(event, papers, categoryName) {
                let html = `<h4>ğŸ“š ${categoryName} ã®è«–æ–‡ä¸€è¦§ <span class="paper-count">${papers.length}</span></h4>`;
                
                papers.forEach(paper => {
                    html += `
                        <div class="paper-item">
                            <div class="paper-title">${paper.title}</div>
                            <div class="paper-meta">
                                ${paper.journal} ${paper.year} ${paper.details}
                            </div>
                        </div>
                    `;
                });
                
                this.paperTooltip.innerHTML = html;
                this.paperTooltip.classList.add('visible');
                this.updatePaperTooltipPosition(event);
            }

            hidePaperTooltip() {
                this.paperTooltip.classList.remove('visible');
            }

            updatePaperTooltipPosition(event) {
                const tooltipRect = this.paperTooltip.getBoundingClientRect();
                const windowWidth = window.innerWidth;
                const windowHeight = window.innerHeight;
                
                let left = event.clientX + 15;
                let top = event.clientY - 15;
                
                if (left + tooltipRect.width > windowWidth) {
                    left = event.clientX - tooltipRect.width - 15;
                }
                
                if (top + tooltipRect.height > windowHeight) {
                    top = windowHeight - tooltipRect.height - 10;
                }
                
                this.paperTooltip.style.left = `${left}px`;
                this.paperTooltip.style.top = `${top}px`;
            }
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†æ™‚ã«ç³»çµ±æ¨¹ã‚’ä½œæˆ
        document.addEventListener('DOMContentLoaded', function() {
            new TreeChart('tree-chart', treeData);
        });
    </script>
</body>
</html>
